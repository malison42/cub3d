#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "../../libft/libft.h"
// –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ ft_isdigit –∏ ft_strlen –¥–æ—Å—Ç—É–ø–Ω—ã
int ft_isdigit(int c); // –ó–∞–≥–ª—É—à–∫–∞
size_t ft_strlen(const char *str); // –ó–∞–≥–ª—É—à–∫–∞

// --- –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è get_col (–¥–ª—è —Ç–µ—Å—Ç–∞, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–¥–µ—Å—å –∏–ª–∏ –≤ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º —Ñ–∞–π–ª–µ) ---
int	get_col(char *str)
{
	int	channel;

	if (!str || !*str)
		return (-1);
	channel = 0;
	while (ft_isdigit(*str))
	{
		if (channel > 25)
			return (-1);
		channel = channel * 10 + (*str) - '0';
		if (channel > 255)
			return (-1);
		str++;
	}
	if (*str)
		return (-1);
	return (channel);
}


typedef struct s_test
{
    char    *input;
    int     expected;
    char    *description;
} t_test;

// ---------------------------------------------------------------------------------

/**
 * @brief –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ get_col.
 * @param tests –ú–∞—Å—Å–∏–≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.
 * @return –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (0 –ø—Ä–∏ —É—Å–ø–µ—Ö–µ).
 */
int run_tests_get_col(t_test tests[])
{
    int i = 0;
    int success_count = 0;
    int total_tests = 0;

    printf("--- üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ get_col ---\n");

    while (tests[i].input != NULL || tests[i].description != NULL)
    {
        int result = get_col(tests[i].input);

        printf("–¢–µ—Å—Ç %02d [%-25s]: ", i + 1, tests[i].description);

        if (result == tests[i].expected)
        {
            printf("‚úÖ OK (–†–µ–∑—É–ª—å—Ç–∞—Ç: %d)\n", result);
            success_count++;
        }
        else
        {
            printf("‚ùå FAIL (–û–∂–∏–¥–∞–ª–æ—Å—å: %d, –ü–æ–ª—É—á–µ–Ω–æ: %d)\n", tests[i].expected, result);
        }
        i++;
        total_tests++;
    }

    printf("\n–ò—Ç–æ–≥: –ü—Ä–æ–π–¥–µ–Ω–æ %d –∏–∑ %d —Ç–µ—Å—Ç–æ–≤.\n", success_count, total_tests);

    return (total_tests - success_count);
}

// --- –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è main ---

int main(void)
{
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    char *null_ptr = NULL;

    // –ú–∞—Å—Å–∏–≤ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è get_col
    t_test get_col_tests[] = {
        {"255", 255, "–í–∞–ª–∏–¥–Ω–æ: –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞"},
        {"0", 0, "–í–∞–ª–∏–¥–Ω–æ: –ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞"},
        {"150", 150, "–í–∞–ª–∏–¥–Ω–æ: –°—Ä–µ–¥–Ω–µ–µ"},
        {"005", 5, "–í–∞–ª–∏–¥–Ω–æ: –ù–∞—á–∞–ª—å–Ω—ã–µ –Ω—É–ª–∏"},
        // --- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ---
        {null_ptr, -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: NULL-—É–∫–∞–∑–∞—Ç–µ–ª—å"},
        {"256", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (>255)"},
        {"1000", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ"},
        {"2 5", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ü—Ä–æ–±–µ–ª (–º—É—Å–æ—Ä)"},
        {"123a", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ë—É–∫–≤—ã –ø–æ—Å–ª–µ —Ü–∏—Ñ—Ä"},
        {"a123", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç"},
        {"", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞"},
        {"2147483648", -1, "–ù–µ–≤–∞–ª–∏–¥–Ω–æ: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ INT"},
        {NULL, 0, NULL} // –¢–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä –º–∞—Å—Å–∏–≤–∞
    };

    int failed_count;

    // –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫
    failed_count = run_tests_get_col(get_col_tests);

    // –í —ç—Ç–æ–º –º–µ—Å—Ç–µ –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤—ã –¥—Ä—É–≥–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
    // failed_count += run_tests_parse_color(parse_color_tests);

    printf("---------------------------\n");
    if (failed_count == 0)
    {
        printf("üéâ –í—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã!\n");
        return (EXIT_SUCCESS);
    }
    else
    {
        printf("üíî –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: %d\n", failed_count);
        return (EXIT_FAILURE);
    }
}
